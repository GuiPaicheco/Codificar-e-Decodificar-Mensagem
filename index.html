<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>RSA Interativo ‚Äì Codifica√ß√£o</title>

  <style>
    * {
      box-sizing: border-box;
      font-family: "Segoe UI", Arial, sans-serif;
    }

    body {
      margin: 0;
      min-height: 100vh;
      background: linear-gradient(135deg, #020617, #0f172a);
      color: #e5e7eb;
      display: flex;
      justify-content: center;
      padding: 20px;
    }

    .container {
      width: 100%;
      max-width: 900px;
      background: #020617;
      border-radius: 20px;
      padding: 26px;
      box-shadow: 0 25px 50px rgba(0,0,0,0.6);
    }

    h1 {
      text-align: center;
      margin-bottom: 6px;
      font-size: 28px;
    }

    p.subtitle {
      text-align: center;
      font-size: 14px;
      color: #94a3b8;
      margin-bottom: 24px;
    }

    h2 {
      margin-top: 30px;
      font-size: 20px;
      border-left: 4px solid #2563eb;
      padding-left: 10px;
    }

    label {
      display: block;
      margin-top: 16px;
      font-weight: 600;
    }

    input, textarea, button {
      width: 100%;
      margin-top: 6px;
      padding: 12px;
      border-radius: 12px;
      border: 1px solid #1e293b;
      background: #020617;
      color: #e5e7eb;
      font-size: 16px;
    }

    textarea {
      resize: none;
    }

    button {
      background: linear-gradient(135deg, #2563eb, #1d4ed8);
      border: none;
      font-weight: bold;
      cursor: pointer;
      margin-top: 20px;
    }

    button:hover {
      filter: brightness(1.1);
    }

    .grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 14px;
    }

    @media (max-width: 600px) {
      .grid { grid-template-columns: 1fr; }
    }

    .output {
      margin-top: 20px;
      padding: 18px;
      background: #020617;
      border-radius: 14px;
      border: 1px solid #1e293b;
      font-size: 15px;
      white-space: pre-wrap;
    }

    .info {
      margin-top: 20px;
      padding: 16px;
      background: #020617;
      border-radius: 14px;
      border: 1px solid #1e293b;
      font-size: 14px;
      color: #cbd5f5;
    }

    footer {
      text-align: center;
      margin-top: 30px;
      font-size: 12px;
      color: #64748b;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>RSA ‚Äì Codifica√ß√£o de Mensagens</h1>
    <p class="subtitle">Projeto Web did√°tico do algoritmo RSA (expoente p√∫blico e = 3)</p>

    <div class="info">
      <strong>Sobre o projeto:</strong><br>
      Esta aplica√ß√£o foi desenvolvida para demonstrar, de forma visual e acess√≠vel, o processo de <b>codifica√ß√£o RSA</b>, conforme solicitado na atividade acad√™mica. O foco est√° na compreens√£o das etapas matem√°ticas e na correta implementa√ß√£o do algoritmo.
    </div>

    <label>Mensagem (A‚ÄìZ e espa√ßo)</label>
    <textarea id="mensagem" rows="3" placeholder="Ex: SEGURANCA E VIDA"></textarea>

    <div class="grid">
      <div>
        <label>Primo p</label>
        <input type="number" id="p" value="17" />
      </div>
      <div>
        <label>Primo q</label>
        <input type="number" id="q" value="29" />
      </div>
    </div>

    <button onclick="codificar()">üîê Codificar Mensagem (RSA)</button>
    <button onclick="emBreve()">üîì Decodificar (em breve)</button>

    <h2>Resultado ‚Äì Passo a passo</h2>
    <div class="output" id="resultado">Preencha os campos acima e clique em <b>Codificar Mensagem</b>.</div>

    <footer>
      Trabalho acad√™mico ‚Äì Programa√ß√£o Web & Criptografia RSA<br>
      Desenvolvido por Arthur Heringe Gon√ßalves e Guilherme Paicheco Ferreira ‚Äì Ci√™ncia da Computa√ß√£o<br>
      Atualiza√ß√µes em breve...
    </footer>
  </div>

  <script>
    const tabela = {
      'A':10,'B':11,'C':12,'D':13,'E':14,'F':15,'G':16,'H':17,'I':18,'J':19,
      'K':20,'L':21,'M':22,'N':23,'O':24,'P':25,'Q':26,'R':27,'S':28,'T':29,
      'U':30,'V':31,'W':32,'X':33,'Y':34,'Z':35,' ':99
    };

    function modPow(base, exp, mod) {
      let result = 1n;
      let b = BigInt(base);
      let e = BigInt(exp);
      let m = BigInt(mod);
      while (e > 0n) {
        if (e % 2n === 1n) result = (result * b) % m;
        b = (b * b) % m;
        e /= 2n;
      }
      return result;
    }

    function codificar() {
      const msg = document.getElementById('mensagem').value.toUpperCase();
      const pVal = document.getElementById('p').value;
      const qVal = document.getElementById('q').value;
      const out = document.getElementById('resultado');

      if (!msg || !pVal || !qVal) {
        out.textContent = 'Erro: preencha a mensagem e os valores de p e q.';
        return;
      }

      const p = BigInt(pVal);
      const q = BigInt(qVal);
      const n = p * q;

      let numerico = '';
      for (let c of msg) {
        if (!(c in tabela)) {
          out.textContent = 'Erro: a mensagem cont√©m caracteres inv√°lidos.';
          return;
        }
        numerico += tabela[c];
      }

      let blocos = [];
      let i = 0;
      while (i < numerico.length) {
        let b3 = numerico.substring(i, i+3);
        if (b3.length === 3 && b3[0] !== '0' && BigInt(b3) < n) {
          blocos.push(BigInt(b3));
          i += 3;
        } else {
          blocos.push(BigInt(numerico.substring(i, i+2)));
          i += 2;
        }
      }

      let cod = blocos.map(b => modPow(b, 3n, n));

      out.textContent =
        'Etapa 1 ‚Äì Chave p√∫blica\n' +
        'n = p ¬∑ q = ' + n + '\n\n' +
        'Etapa 2 ‚Äì Pr√©-codifica√ß√£o\n' +
        numerico + '\n\n' +
        'Etapa 3 ‚Äì Blocos v√°lidos (< n)\n' +
        blocos.join(' | ') + '\n\n' +
        'Etapa 4 ‚Äì Codifica√ß√£o RSA (b¬≥ mod n)\n' +
        cod.join(' | ');
    }

    function emBreve() {
      document.getElementById('resultado').textContent =
        'Funcionalidade de decodifica√ß√£o em desenvolvimento.\n\n' +
        'Nesta vers√£o, o foco do projeto √© apresentar de forma clara e visual o processo de codifica√ß√£o RSA, conforme solicitado na atividade.';
    }
  </script>
</body>
</html>
